# Bulbulator
Проект усовершенствовния увлажнителя воздуха Vitek VT-1764 BK, с использованием arduino uno, nano, wi-fi модуля esp1866, комплекта радиосвязи.
Система состоит из двух блоков: Основной блок (сам увлажнитель), и блок датчиков, чтобы иметь возожность вынести датчики на другой конец комнаты, не используя провода.

Блоки:
1. Основной блок увлажниеля:
- Ардуино Уно
- Wi-fi модуль esp1866 спрошивкой DeviceHive http://devicehive.com
- Приемник 433 MGz (нужно заменить на более надежный)
--------------------
Использованные сторонние библиотеки:
- VirtualWire.h
- TM1628ts.h (переработана для использования с Витековским дисплем, оригинал этой библиотеки тут: https://github.com/onetransistor/MyDuinoLibs/tree/master/Display_Segment/TM1628ts )
- IRremote.h

2. Блок датчиков (на выносе):
- Ардуино Нано (можно Уно)
- Датчик влажности и температуры DHT22 (нужно заменить на более точный инадежный)
- Датчик давления BMP180
- Передатчик433 MGz (нужно заменить на более надежный)
- OLED дисплей I2C 96x64
--------------------
Использованные сторонние библиотеки:
- BMP085.h 
- DHT.h 
- OzOLED.h ( https://github.com/SensorsIot/TinyOzOled )
- VirtualWire.h ( оригинал тут: http://www.airspayce.com/mikem/arduino/VirtualWire/files.html )

Возможности:
- Все стандартные возможности увлажнителя VT-1764BK, такие как увлажнение воздуха, ионизатор, подогрев воды, поддержание заданной влажности. 
Добавлено в доработанной версии:
+ Сохранение всех настраиваемых параметров в энергонезависимую память (при переключении в режим "Выключено")
+ Автоматическое включение подогрева воды, в случае низкой влажности (менее 40%)
+ Индикация атмосферного давления на месте таймера
+ Управление через web-интерфейс (код html страницы для сервера devicehive в проекте)
+ Добавлено автоматическое управление яркостью дисплея, по фотосенсору, установленному в выносном блоке датчиков
- - Таймер пока не реализован за ненадобностью (лень пока писать)

Доработки штатного железа:
- Ардуино подключается на место выпаянной микросхемы штатного контроллера (пины не сложно выясняются по разводке печатной  платы)
- Добавляется стабилизатор на 3,3В, для работы wi-fi модуля (В его обвязку ставятся кондесаторы на 470-1000 мкф + на 1-5 мкф). Запитывать его от 3,3В Ардуины нельзя, слишком большие токи потребления.
- На плате контроллера изменен номинал фильтра-конденсатора в цепи 5В со 100 на 1000 мкф.
- На плате контроллера добавлен конденсатор на 2200 мкф в цепи 12В
- На плате реле включения подогрева добавлен диод (припаиватся в обратной полярности к контактам управления реле, для гашения обратного тока)
- На плате реле включения подогрева добавлен конденсатор на 100 мкф (припаиватся в прямой полярности к контактам управления реле), для гашения помех при включении/выключении реле

// если не выполнить последние 4 пункта, то ардуино и wi-fi модуль постоянно зависают, при включении/выключении подогрева, а так же заметно мерцание дисплея, при передаче пакетов по wi-fi (модуль кушает много тока (200-250 мА) при активации wi-fi передачи)
